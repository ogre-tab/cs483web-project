<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href= "{{ url_for('static',filename='styles/results.css') }}">
        <title>Super Search: Results</title>
</head>
<body class ="grid-container">
    <!--<div class="grid-container">-->
    <div class="item1" >
                    <ul id="header">
                        <li class="catitem" onclick="getPowerView('Enhancements')">Enhancements</li>
                        <li class="catitem" onclick="getPowerView('Mental Powers')">Mental Powers</li>
                        <li class="catitem" onclick="getPowerView('Personal Powers')">Personal Powers</li>
                        <li class="catitem" onclick="getPowerView('Mimicry')">Mimicry</td>
                        <li class="catitem" onclick="getPowerView('Manipulations')">Manipulations</li>
                        <li class="catitem" onclick="getPowerView('Almighty Powers')">Almighty Powers</li>
                    </ul>
        <div>
            <form method="get" action="{{ url_for('results') }}">
                <input type="text" name="query">
                <button type="submit" value="Search">Submit</button>
            </form>
        </div>
    </div>
    <div class="results_view" id="results-view">   
        <!-- RESULTS LIST VIEW-->
        {{results_view|safe}}
    </div>
    <div class="power_view" id="power-view">   
        <!-- MAIN POWER VIEW-->
        {{power_view|safe}}
    </div>
</body>
    <script type="text/javascript">
        //var power_name = "Telekinesis" /* example */
        /* accepts power name by exact title match or error */
        function getPowerView(power_name){
            var power_data
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    power_data = this.responseText;
                    console.log("retrieved data for " + power_name);
                    //console.log(power_data)
                    document.getElementById("power-view").innerHTML = power_data;
                }
            };
            xmlhttp.open("GET", "search?div=pow&power="+power_name, true);
            xmlhttp.send();
            document.getElementById("power-view").innerHTML = "<h2>Loading...</h2>";   // Blank page
        }
        
        
        var current_page_num = 1
        var keywordquery = "{{this_query|safe}}"
        var results_list = {{results_list|safe}}
        //this part will be useful later on probably
        
        function getResultsPage(page_num){
            var results_pane
            if (page_num == '>')
                current_page_num += 1
            else if (page_num == '<')
                current_page_num -= 1
            else
                current_page_num = page_num
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    results_pane = this.responseText;
                    console.log("retrieved page " + current_page_num);
                    document.getElementById("results-view").innerHTML = results_pane;
                }
            };
            xmlhttp.open("GET", "search?div=res&query="+keywordquery+"&p="+current_page_num, true);
            xmlhttp.send();
        }
        
    </script>
</html>
